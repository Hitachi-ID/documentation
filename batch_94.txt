Argument Description
-cert-subject <subject> Subject of the SAML document signing certific a t e  (e.g.
"Bravura Security") (required).
-certfile  <filename> Public certific a t e  output filename  (.cer format).
-echopwd Report back (on standard out) the encrypted pfx
password.
-idpurl <url> Public facing URL of IdP (e.g. http s://hids.c ompan y .c om/
de f ault/  ).
-makecert Create a new root and document signing certific a t e.
-mdfile  <filename> Output filename  to store metadata.
-metadata Generate IDP meta-data
-pass <password> The encr yption  password used by the PFX (Personal
In f ormation  Exchange) file.
-pfx <p fxfile> Signing certific a t e  in PFX (Personal In f ormation  Exchange)
format (REQUIRED)
-root-subject <subject> Subject of the self-signed root certific a t e  (e.g. "Bravura
Security Root")
-years <years> The number of years the generated PFX file is valid for.
-silent Supress success messages.
Examples
1.Generate a new PFX:1.
fedidp-util.exe -makecert -pfx saml.pfx -cert-subject SAML -root-
subject "Bravura Security" -pass p455w0rD -years 3
2.Generate IDP metadata and public certific a t e  from the PFX: 2.
fedidp-util.exe -metadata -pfx saml.pfx -mdfile mdoutput -
pass p455w0rD -idpurl 10.0.1.68 -cert-subject SAML -
certfile public.cer
.
Authentic ation  chains
Installing the SAML component will override the DEFAULT_LOGIN and HELPDESK_LOGIN authentic ation
chains, and can render your Bravura Security Fabric instance inaccessible. Following ins t allation  of this
module, ensure that DBE tables hid_authchain_select and sp_access are c onfigured  to enable a valid
authentic ation  method for both regular and federated logins. Bravura Security  recommends using the
authcfg program to export authentic ation  chain settings  before modifying the default c onfiguration.
The default USER_IDENTIFICATION authentic ation  chain is c on figur ed  to include the fedidp_ident
module by default for any new instance. This module captures and parses SAML requests sent by an SP . Ifthe SAML request specifies  a valid user pr ofile  in the ”subject” parameter, then this module will proceed
past the user identific ation  step as though the user had already provided their pr ofile  ID.
Fedidp_ident must be the fir s t module called for any authentic ation  chain that will handle SAML
authentic ation,  or the initial  SAML request will not be captured.
When single sign-on authentic ation  is enabled, fedidp_ident is responsible for reading and v alidating  the
web browser cookie used to associate SAML requests to an e xisting  SSO session. By default, an SSO
session is terminated when the user logs out of Bravura Security Fabric , however service providers that
support single log-out can pass the SAMLLogout=1 GET parameter to this module in order to terminate
the user’s current SSO session.  
SAML 
Custom authentic ation  chain SAML is called when users provide a SAML request parameter as part of an
SP -initia t ed  login. This authentic ation  chain is c on figur ed  to call the following modules:
▪Fedidp_cs federated login chain selector. This module leverages the sp_authchain external database ▪
table in order to determine which authentic ation  chains a federated login will use. By default, this
chain directs users to the REGUSER chain.
This plugin makes use of the Allow plugin to skip chain selection  setting.  When enabled, Fedidp_cs
will skip chain selection  for users with an activ e  SSO session who already meet authentic ation
requirements for the target SP , authentic ating  these users without requiring them to re-input their
cr edentials.  Users without an activ e  SSO session or those who have not met all the authentic ation
criteria will be forced to complete remaining chains. Users lacking authoriz ation  to access the target
SP , or login attemp ts  to SPs that are not enabled or available will have their requests denied.
▪The Fedidp_assert module is the last step in SAML authentic ation,  and uses a pr e-de fined  PFX ▪
certific a t e  to sign the assertion  generated by the fedidp_response plugin that will be sent to the SP .
Single sign-on (SSO) session behavior is enabled or disabled in this module via the Single sign-on
mode setting ,  which c on figur es  how SSO session data is tracked:
▪Enabled (default): An SSO session is always created or updated when a user completes federated ▪
login.
▪Disabled : SSO session in f ormation  is never created or updated. ▪
▪Prompt : Upon c ompleting  federated login, users are asked whether SSO session data should be ▪
retained before they are redirected to the SP .
The Fedidp_assert issues or updates a browser cookie for the user whenever SSO session
in f ormation  would be updated. This cookie is read by the Fedidp_ident module when the user
attemp ts  authentic ation  to other SPs during the dur ation  of their session.
This module is also responsible for r edir ecting  successfully authentic a t ed  end users to their SP .
REGUSER 
Custom authentic ation  chain REGUSER is used by several Bravura Security Fabric  component
ins t allations,  and is responsible for the actual authentic ation  of SAML users. By default, this module will
authentic a t e  federated logins using the password / security questions  modules.External database tables
hid_authchain_select 
This table is used by several Bravura Security Fabric  component ins t allations,  and overrides the normal
authentic ation  chain selection  process. With the SAML c on figur ation  installed, this table directs any user
that has provided a SAML_REQUEST POST parameter to the SAML authentic ation  chain.
After  installing the Scenario.hid_saml_idp component the following rule should exist:
RuleNumber =120
Comment SAML authentic ation  chain
Proceed False
MatchType sessdata
MatchKey SAML_REQUEST
Ma t chCondition set
MatchValue <null>
Action flush
ChainId SAML
Installing this component in stand-alone mode on a new instance will override all default authentic ation
chains, and may prevent non-SAML and console users from logging into Bravura Security Fabric. To avoid
this, c onfirm  that the hid_authchain_select table includes a valid chain for users authentic ating  without a
SAML_REQUEST before c ontinuing.
sp_mapping 
This table associates each SP issuer with an sp_folder value, and sets parameters used in g ener ating  a
SAML assertion,  if they were not de fined  by the request.
sp_mapping table columns
Option Description
issuer (Required) This parameter is passed along side the SP’s initial
SAML request, and de fines  which SP the request came from.sp_folder (Required) The sp_folder value refers to an actual folder
installed to the <Instance>\idp directory of your instance
server, and contains both the saml-response.xml template used
to generate SAML responses for that SP , as well as the icon.png
file acting  as this SP’s icon image for IdP -initia t ed
authentic ation
acs_url The URL to which successfully authentic a t ed  users should be
redirected, if it diff er s  from the issuer. In an SP -initia t ed
authentic ation,  the acs_url provided by the SP will take
precedence. In order to support IdP -initia t ed  authentic ation,
this value must be de fined
idp_url The URL of the identity  provider service. IdP service is provided
by Front-end (PSF) by default.
enabled (Required) Enable or disable SAML requests from the specified
SP . By default, all SPs are disabled, and at least one must be
enabled in order to perform federated authentic ation.
idp_initia t ed (Required) Con figur e  whether the applic ation  can nativ ely
support IdP -initia t ed  SSO. If set to 0, the launchpad will
simulate it via SP Initia t ed  SSO.
disp_name The user-friendly label for this service provider that will be
displayed to users on the applic ation  launchpad page. By
default, the name of the sp_folder is used.
default_pin Con figur e  whether the launchpad button  for this SP should be
pinned to Front-end (PSF) by default for users that have access
to it.
relay_state Set a default relayState parameter to be passed to the SP
alongside the SAML assertion.  Some SPs require this parameter
for authentic ation.  During SP -initia t ed  authentic ation,  the
relayState provided by the service provider takes precedence
sig_logic (Required) This option  c on figur es  the signing of a SAML
response or SAML assertion  to ensure message integrity when
a r esponse/ assertion  is delivered to a Relying Party.
sp_access
This table de fines  which user classes are given access to federated login for a particular  SP . This table acts
as a sub tr activ e  filt er ,  where access is granted to all user classes that are not explicitly denied here.
sp_access table columns
Option Description
sp_folder (Required) The sp_folder used for this SP’s issuer. This
should be the same value as de fined  in sp_mapping.
userclass (Required) The user class ID to c on figur e  access
controls for.Option Description
deny_acl (Required) De fine  whether or not the selected user
class is prohibited from accessing the specified  SP
through federated login.
sp_authchain
This table de fines  which authentic ation  chains should be used when logging into a particular  SP , and is
used by the fedidp_cs authentic ation  chain module.
sp_authchain table columns
Option Description
sp_folder (Required) The sp_folder used for this SP’s issuer.
This should be the same value as de fined  in
sp_mapping. This table can also direct users who are
not making SAML requests, by setting  this value to
"__non_saml__".
userclass The user class that authentic ating  users must belong
to in order to use the specified  authentic ation  chain.
If the user class is unspecified,  then any
authentic ating  user who does not match another
rule in this table is able to use the specified
authentic ation  chain.
authchain The authentic ation  chain to be used for this issuer. If
no authentic ation  chain is de fined  for an issuer, then
users authentic ating  to that SP are allowed to use
any of the authentic ation  chains de fined  on the
system. If an SP does have values de fined  here, then
only those authentic ation  chains listed here will be
used for authentic ation.
Target system
Installing the Scenario.hid_saml_idp component aut omatic ally  adds an Activ e  Directory target
system with the system ID of "AD". The target system is c on figur ed  to be a source of pr ofiles.  When users
login, they will validated against their Activ e  Directory cr edentials.
Add a service provider to the Bravura Security Fabric IdP
Bravura Security Fabric  has pre c on figur ed  templates  (on page 929) for several SPs.
If your SP does not have a current template, follow the procedure to add a service provider that is not
pr e-c on figur ed  in Bravura Security Fabric  (on page 948).Pr e-c on figur ed  templates
If your SP has a pre c on figur ed  templates  (on page 929) follow this process to integrate the SP with
Bravura Security Fabric  IdP:
1.As superuser on the IdP server navigate to Manage external data store > sp_mapping 1.
2.Enable the sp_mapping table issuer that corresponds to your service provider:2.
▪Rows will exist for the following SPs: bamboohr, google, webex, hcpa, adfs, youtrack, salesforce and▪
azure.
▪All rows have a value of 0 in the enabled column, by default. Change the value in the row for your▪
service provider to 1.
▪Ensure the following field  values match the values used on the service provider. In Salesforce these ▪
values can be found in the SAML Single Sign on settings.
▪issuer In Salesforce this is called the Entity  ID ▪
▪sp_folder contains __non_saml__, and <sp folder name on the Bravura Security Fabric  IdP ▪
server>
▪acs_url  In Salesforce this is the Login URL. ▪
▪idp_url  In Salesforce this is the issuer entry . ▪
a.Click Update a.
3. Optional:  As superuser on the IdP server navigate to Manage external data store > sp_access and edit 3.
the following entries if you want to restrict access to the service provider to a more specific  set of
users:
▪sp_folder: contains __non_saml__, and <sp folder name> ▪
▪userclass: _ALLUSERS_ ▪
▪deny_acl: 0 ▪
4.Click Update 4.
5. Optional:  As superuser on the IdP server navigate to Manage external data store > sp_authchain and 5.
edit the following entries if you have diff er en t  authentic ation  requirements:
▪sp_folder: contains __non_saml__, and <sp folder name> ▪
▪authchain: column values are set to REGUSER ▪
6.Click Update 6.
Example: Con figur e  a Salesforce service provider
If your or g aniz ation  makes use of the Salesforce service, it can be c on figur ed  to allow end users to login
via Bravura Security Fabric .
1.Log into Salesforce as an administrator.1.
2.Add SAML Single Sign-On Settings  for Bravura Security Fabric : 2.
a.Navigate to the Single Sign-On Settings  c on figur ation  page ( Settings  > Identity  > Single Sign-On a.
Settings ).b.Click New  from Metadata file. b.
c.Browse to the <instance>\idp folder on your Bravura Security Fabric  instance to find the idp- c.
metadata.xml file.
d.Select idp-metadata.xml and click Create . d.
3. Con figur e  SAML Single Sign-on Settings  in Salesforce: 3.
a.Choose a Name for the IdP c on figur ation. a.
This will appear on the Salesforce Login page.
You can also update the API Name ; but it should aut omatic ally  be corrected by Salesforce upon
import.
b.Note the value of the Entity  ID. b.
This will be used by Salesforce to identif y  itself to Bravura Security Fabric .
c.If required, update the Issuer value with the hostname of the Bravura Security server. c.
This is populated by default with https://<Bravura Security Host>/
instance/sso/
d.Select the SAML Identity  Type that you expect Bravura Security Fabric  to send to Salesforce in d.
order to uniquely identif y  users when they log in.
If unsure leave this as the Salesforce username.
e.Select the SAML Identity  Loc ation . e.
By default this should be the NameIdentifier  element of the Subject.
f.Ensure that HTTP Redirect is selected for Service Provider Initia t ed  Binding . f.g.Click Save . g.
h.Once saved successfully, make note of the Login URL in the Endpoints section  near the bottom. h.
This is used to tell Bravura Security where to send the SAML assertion.