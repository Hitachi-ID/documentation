 See also: 
Bravura Security Fabric  uses the ECMAScript regular expression grammar. For more in f ormation  on
regular expressions supported by Bravura Security Fabric , see:
▪The ECMA Script Language Specific ation  at: ▪
http://w w w .ecma-in t ernational.or g /public ations/files/E CMA -S T /E cma-262.pdf
or
▪The Micr osoft  Developer Network (MSDN) TR1 Regular Expressions document at: ▪
http://msdn.micr osoft.c om/ en-us/libr ar y/bb982727.asp x
for more in f ormation.
You can also use the Manage the system  (PSA) module to view the log:
▪From the last e x ecution  of auto discovery ▪
See Viewing the last auto discovery log  (on page 2736).
▪For a given target system’s connector▪
See Viewing target system logs  (on page 521).
Log analysis 
The add-on Log Analyzer was removed from Bravura Security Fabric  in version 10.0.0. Bravura Security
recommends using a log analysis product such as ELK (Elastic  Search/Logstash/Kibana), which can be
downloaded at: http s://w w w .elastic.c o/ .
Windows Event Log
You can view the event logs using Windows Event Viewer (eventvwr). Some events that are relevant to
Bravura Security Fabric  are recorded in the Windows event logs. This includes:
▪Fatal errors; for example, if  Bravura Security Fabric  program quits unexpectedly. ▪
▪Events generated by third-party applic ations;  for example, your database client or the Windows ▪
Installer.
▪System events, such as service start up and shut down.▪
▪Logon or log off  events for the Windows server. ▪
Exit traps can also trigger events. Such events are logged in Applic ations  and Services Logs > Hitachi >
Hitachi ID Systems > Hitachi ID Suite . Errors are logged into the Admin folder, and in f ormation  and
warnings are logged into the Oper ational  folder. The audit-events.man file contains a list of
supported exit traps, located in the Common Files > Hitachi ID  directory.
Consult your Windows Help for more in f ormation  about Windows Event Viewer.
Best Pr actice:  Shipping events to SIEM systems
Regular monitoring of the Bravura Security Fabric  is crucial to maintaining a highly available service.
Administrators and security teams should be aware of pot ential  c on figur ation  or security issues, and a
SIEM solution  provides the ability to see events in r eal-time,  review historical events, and even identif ytrends and other analytics  over a period of time.  Therefore it is best pr actice  to integrate the Bravura
Security Fabric  with e xisting  SIEM solutions  to better  facilitate this kind of pr oactiv e  maintenance.
Challenge: syslog versus SIEM in t egr ation
The built-in syslog support within the Bravura Security Fabric  is a legacy in t egr ation  point that is no
longer activ ely  developed or improved. As SIEM solutions  have matured over the years, the necessity of
direct syslog in t egr ation  has become less and less relevant, and so demand for extending the syslog
feature has also been low.
As such, Bravura Security no longer recommends using syslog transmission of event data.
Syslog is a lossy protocol
Syslog is not a reliable delivery method and events can be dropped when network issues occur between
the applic ation  server(s) and the SIEM system. Messages cannot be queued and r e tr ansmitted  in the
event the c onnectivity  is not available. Furthermore, to minimize performance e ff ects  on overall log
transmission, UDP tends to be used for transmissions and this is a naturally lossy protocol.
Syslog over TLS is not supported
While tr ansmitting  syslog messages over TLS is possible (see http s://da t a tr ack er .ietf.or g /doc/h tml/
rf c5425 ), this is not supported by the Bravura Security Fabric  logging service, nor will support be added in
the future.
Best pr actice  solution
For on-premise deployments, Bravura Security  recommends that log c ollection  agents for SIEM systems be
installed on Bravura Security Fabric  applic ation  servers and proxy servers to securely and e fficien tly
transmit this in f ormation  over HTTPS. Log c ollection  agents generally operate by tracking the loc ation  in
the files and the Windows event logs that were last processed, and then tr ansmitting  content in bulk to
servers when c onnectivity  exists.
Log c ollection  agents can then be c on figur ed  to transmit the in f ormation  that is located in:
▪The Bravura Security Fabric  applic ation  log file directories: ▪
<Program Files path>\Bravura Security\Bravura Security Fabric\Logs\<instance>\
▪The Windows Event Log audit event storage loc ation: ▪
Applic ations  and Services Logs > Hitachi > Hitachi ID Systems > Hitachi ID Suite .
Errors are logged into the Admin folder, and in f ormation  and warnings are logged into the
Oper ational  folder.
The highest value and best quality messages to be processed include:
▪The audit events in the Hitachi ID Windows Event Log loc ation.  These cover a range of high value ▪
actions  that are of interest to security event systems.
▪Performance messages in the Bravura Security Fabric  applic ation  log files.  These are well structured ▪
messages that are identified  at level "Perf" in the logs.Windows Audit Event Reference
Event ID Symbolic ID Description
1 AUTH_CHAIN_FAILURE User failed to authentic a t e
2 AUTH_CHAIN_SUCCESS User successfully authentic a t ed
3 USER_LOGIN_LOCKOUT User lockout is triggered
4 DB_COMMIT_SUSPEND Database commits suspended, r eplic ation  queue
full
5 DB_COMMIT_RESUME Database commits resuming
6 DB_REPLICATION_CONN_FAILURE Connectivity  to replica database lost
7 DB_REPLICATION_CONN_RESTORED Connectivity  to replica database restored
8 DB_REPLICATION_TRANS_FAILURE Failed to replicate database tr ansaction
9 DB_QUEUE_INSERT_FAILURE Failed to insert data into database r eplic ation
queue
10 DB_FAILED_PROC_RECORDED Failed to run stored procedure on replica server
11 PAMSA_ORCHESTRATION_START_FAILURE Subscriber or ches tr ation  failed to start
12 PAMSA_ORCHESTRATION_END_FAILURE Subscriber or ches tr ation  completed with failures
13 UPDATE_RESOURCE_FAILURE Failed to update subscriber password
14 GSET_CHECKIN_FAILURE Failed to check-in managed group set
15 GSET_CHECKIN_PARTIAL Failed to fully check-in managed group set, some
memberships were not revoked
16 GSET_CHECKIN_SUCCESS Managed group set successfully checked in
17 GSET_CHECKOUT_SUCCESS Managed group set successfully checked out
18 GSET_CHECKOUT_FAILURE Failed to check out managed group set
19 GSET_CHECKOUT_PARTIAL Managed group set partially  checked out, some
memberships were not granted
20 PWD_CHECKOUT_SUCCESS Managed account password successfully checked
outEvent ID Symbolic ID Description
21 PWD_CHECKOUT_FAILURE Failed to check-out managed account password
22 PWD_CHECKIN_SUCCESS Managed account password successfully checked
in
23 PWD_CHECKIN_FAILURE Failed to check-in managed account password
24 WSTN_VIEW_PASSWORD_SUCCESS Managed account password viewed
25 WSTN_VIEW_PASSWORD_FAILURE Failed to view managed account password
26 WSTN_VIEW_PASSWORD_HIS_SUCCESS Historical managed account password viewed
27 WSTN_VIEW_PASSWORD_HIS_FAILURE Failed to view historical managed account
password
28 ADMIN_ENABLE_ADMIN Adminis tr ativ e  pr ofile  enabled
29 ADMIN_ENABLE_USER User pr ofile  enabled
30 ADMIN_DISABLE_ADMIN Adminis tr ativ e  pr ofile  disabled
31 ADMIN_DISABLE_USER User pr ofile  disabled
32 ADMIN_UNLOCK_ADMIN Adminis tr ativ e  pr ofile  unlocked
33 ADMIN_UNLOCK_USER User pr ofile  unlocked
34 SMON_SESSION_START Privileged access session recording started
35 SMON_SESSION_END Privileged access session recording ended
36 SMON_ADMIN_SESS_TERM_REQ Privileged access session t ermination  requested
by administrator
37 PSUPDATE_START Nightly discovery process started
38 PSUPDATE_FINISH Nightly discovery process finished
39 IDAPI_LOGIN_SUCCESS API login succeeded
40 IDAPI_LOGIN_FAILURE API login failure
41 MAQ_CHECKIN_FAILURE Failed to check in system and account query
based accessEvent ID Symbolic ID Description
42 MAQ_CHECKIN_SUCCESS Succeeded in checking in system and account
query based access
43 MAQ_CHECKOUT_FAILURE Failed to check out system and account query
based access
44 MAQ_CHECKOUT_SUCCESS Succeeded in checking out system and account
query based access
45 TARGET_DEPLOYMENT_FAILURE Target deployment finished  with a failure.
46 TARGET_DEPLOYMENT_SUCCESS Successfully finished  target deployment.
47 OPERATION_IMPORT_TARGET Successfully imported a single target.
48 WSTN_ADD_WSTN_SUCCESS Successfully finished  target deployment.
49 WSTN_ADD_WSTN_FAILURE Target deployment finished  with a failure.
50 IDWFM_EVENT_ABORT W orkflo w  manager aborted event processing.
51 IDWFM_EVENT_FAILURE W orkflo w  manager failed to process event.
52 USER_QA_ADD_SUCCESS Security question  successfully added.
53 USER_QA_ADD_FAILURE Failed to add security question.
54 USER_QA_UPDATE_SUCCESS Security question  successfully updated.
55 USER_QA_UPDATE_FAILURE Failed to update security question.
56 USER_QA_DELETE_SUCCESS Security question  successfully deleted.
57 ADMIN_QA_ADD_SUCCESS Security question  successfully added.
58 ADMIN_QA_ADD_FAILURE Failed to add security question.
59 ADMIN_QA_UPDATE_SUCCESS Security question  successfully updated.
60 ADMIN_QA_UPDATE_FAILURE Failed to update security question.
61 ADMIN_QA_DELETE_SUCCESS Security question  successfully deleted.Event ID Symbolic ID Description
62 USER_PW_RESET_START Self-service password reset started.
63 USER_PW_RESET_SUCCESS Self-service password reset successful.
64 USER_PW_RESET_FAILURE Self-service password reset failed.
65 ADMIN_PW_RESET_START Help-desk assisted password reset started.
66 ADMIN_PW_RESET_SUCCESS Help-desk assisted password reset successful.
67 ADMIN_PW_RESET_FAILURE Help-desk assisted password reset failed.
68 USER_ACCT_UNLOCK_START Self-service account unlock started.
69 USER_ACCT_UNLOCK_SUCCESS Self-service account unlock successful.
70 USER_ACCT_UNLOCK_FAILURE Self-service account unlock failed.
71 ADMIN_ACCT_UNLOCK_START Help-desk assisted account unlock started.
72 ADMIN_ACCT_UNLOCK_SUCCESS Help-desk assisted account unlock successful.
73 ADMIN_ACCT_UNLOCK_FAILURE Help-desk assisted password reset failed.
74 DB_REPLICATION_WATERMARK_WARN Database r eplic ation  watermark hit.
75 USER_ALIAS_ALREADY_CLAIMED User attemp t ed  to claim alias that is already
claimed.
76 ADMIN_ALIAS_ALREADY_CLAIMED Admin attemp t ed  to assign alias that is already
claimed.
77 CONNECTOR_TIMEOUT Connector timed  out while performing oper ation.
78 FILE_REPLICATION_FAILURE Error occured during file r eplic ation  to remote
nodes.
79 IDPM_GROUP_SUCCESS All passwords successfully synchronized.
80 IDPM_GROUP_FAILURE One or more passwords failed to be synchronized.
81 WF_REQUEST_BATCH_APPROVED W orkflo w  request has been approved.
82 WF_REQUEST_BATCH_REJECTED W orkflo w  request has been rejected.
83 WF_REQUEST_BATCH_CANCELED W orkflo w  request has been canceled.Event ID Symbolic ID Description
84 WF_REQUEST_BATCH_REVOKED W orkflo w  request has been revoked.
85 WF_REQUEST_BATCH_PROCESSED W orkflo w  request has been processed.
86 DID_REGISTER_SUCCESS Successfully registered Digital ID.
87 DID_REGISTER_FAILURE Failed to register Digital ID.
88 DID_UPDATE_SUCCESS Successfully updated Digital ID.
89 DID_SEND_SUCCESS Digital ID successfully downloaded.
90 USER_IDENTIFY_SUCCESS User successfully identified
91 USER_IDENTIFY_FAILURE Failed to identif y  user.
92 USER_LOGIN_SUCCESS User successfully logged in.
93 USER_LOGIN_FAILURE User failed to log in.
94 FEDIDP_IDENTIFY_SUCCESS Federated authn request successfully parsed.
95 FEDIDP_IDENTIFY_FAILURE Federated authn request failed to be parsed.
96 FEDIDP_AUTH_SUCCESS Federated assertion  successfully generated.
97 FEDIDP_AUTH_FAILURE Federated assertion  failed to be generated.
98 DB_STORED_PROC_FAILURE Failed to execute stored procedure.
99 ADMIN_CRED_FAILURE Target cr eation  failure: Could not establish
cr edentials.
100 ADMIN_CRED_SUCCESS Target cr eation  successful: Cr edentials  set
successfully.
101 FEDIDP_SSO_SESSION_CREATE New federated SSO session created.
102 FEDIDP_SSO_SESSION_DESTROY Federated SSO session terminated.
103 PAM_CHECKOUT_SUCCESS Generic access check-out successful.
104 PAM_CHECKOUT_PARTIAL Generic access check-out partially  successful.
105 PAM_CHECKOUT_FAILURE Generic access check-out failed.Event ID Symbolic ID Description
106 PAM_CHECKIN_SUCCESS Generic access check-in successful.
107 PAM_CHECKIN_PARTIAL Generic access check-in partially  successful.
108 PAM_CHECKIN_FAILURE Generic access check-in failed.
109 PAM_CHECKOUT_EXPIRY Generic access check-out expired.
110 PAM_CHECKOUT_LIMIT_REACHED Generic access check-out cannot be performed
because it would exceed the check-out limit of
one of its targets.
111 PAM_CHECKOUT_OPERATION_SUCCESS An oper ation  run as part of a generic access
check-out succeeded.
112 PAM_CHECKOUT_OPERATION_FAILURE An oper ation  run as part of a generic access
check-out failed.
113 PAM_CHECKIN_OPERATION_SUCCESS An oper ation  run as part of a generic access
check-in succeeded.
114 PAM_CHECKIN_OPERATION_FAILURE An oper ation  run as part of a generic access
check-in failed.
115 FEDSP_SAMLAUTH_ASR_FAILURE Failed to validate a SAML assertion.
116 FEDSP_SAMLAUTH_ASR_SUCCESS Successfully validated a SAML assertion.
117 FEDSP_SAMLAUTH_ISSUED Issued SAML AuthNRequest.
118 DB_REPLICATION_QUEUE_DELAY_PAST_THRESHOLD Database r eplic ation  queue delay exceeded
c on figur ed  threshold.
119 CRITICAL_FAILURE A critic al  failure was detected.
120 USER_HDD_RECOVERY_FAILURE Self-service encrypted drive recovery failure.
121 USER_MOBILE_DEVICE_REGISTRATION Self-service mobile device r egis tr ation.
 Con figuring  logging levels on an applic ation  server
Use the psdebug program on an applic ation  server to c on figur e  logging output from various Bravura
Security Fabric  softw ar e  components. It is helpful when tr oubleshooting  ins t allation  or functionality
problems.
See psdebug usage
Usage
 psdebug -prog <program> -level <0-5|99> -maxwait <seconds>
 psdebug -prog <program> -submodule <module> -level <0-5|99>
 psdebug -remove
 psdebug -remove <program>
 psdebug -prog <program> -extlevel <level names>
Argument Description
-prog <program> Identif y  the program to change the logging level for.
-submodule <module> For programs or scripts that use IDMLib, identif y  the
submodule to change the logging level for.
-level <N> Set the logging level for programs or scripts, or turn
debugging on or off .
See Setting  the logging level  (on page 2789) for details.
-extlevel <level names> Set extended performance logging levels.
See Setting  the logging level  (on page 2789) for details.
-remove Remove custom debug settings.  Individual programs/
submodules can be specified.
-maxwait <seconds> Set the maxwait parameter to ignore all Perf log events
that are slower than the specified  dur ation.  If the
maxwait argument is not specified  explicitly, then the
default value is set to 15 seconds.
for command-line usage and examples.
The psdebug  utility  allows for adding specific  e x ceptions  (one binary or script at a time)  to global
applic ation-wide  logging settings  c on figur ed  in the Logging Service, for more r e fined  logging. Using
psdebug  allows for smaller, more relevant and more readable logs; there is less interference from other
subsystems when tr oubleshooting  a specific  issue.
Both Logging service and psdebug  c on figur ation  is ser v er -specific.  Their settings  are saved in the
Windows registry in keys which are excluded from File r eplic ation  (on page 2862).
See Logging service  (on page 2854) for global instance logging c on figur ation.
Setting  the logging level
To determine the type of in f ormation  to include in the specified  program’s log file, use the command:
psdebug -prog <program> -level <0-5|99>where logging levels can be:
▪0 No log file generated ▪
▪1 Log errors only ▪
▪2 Log errors and warnings ▪
▪3 Log errors, warnings, and notices ▪
▪4 Log errors, warnings, notices,  and in f ormation  messages (default) ▪
▪5 Log all the above and debugging in f ormation  for the program ▪
▪99 Log all the above and verbose debugging in f ormation ▪
Note:
▪A change in the logging level will take e ff ect  the next time  the program starts or script is run. ▪
▪You may need to test a debug level to obtain the in f ormation  you require. For example; the idpm ▪
service needs to be set to 5 to display the IP address of the Domain Controller that sends a Password
Change notific ation.
▪It is a good idea to keep a list of which binaries and scripts have been set to specific  logging levels. ▪
▪Do not include the program or script’s extension (.exe, .py). ▪
▪PSLang scripts are generally run in-process; so if the w orkflo w  service ( idwfm) runs a PSLang script, ▪
then the script’s logs will show up as being generated by idwfm and they should inherit idwfm’s log
level.
To determine the type of performance in f ormation  to be included in the specified  program’s log file, use
the command:
psdebug -prog <program> -extlevel <level names>
where extended logging levels can be one or both of the following:
▪perf Runtime  performance messages – All binary and script performance are recorded ▪
▪perf_sproc Stored procedure runtime  performance messages – The performance of stored ▪
procedures, called by binaries, is recorded.
This option  has to be added only to the ajax service ( -prog ajaxsvc ).
▪perf_replication Database r eplic ation  messages – The name and dur ation  of replicated stored ▪
procedures is recorded, as well as the send queue in which they are running.
▪perf_lws Local w ork s t ation  runtime  performance messages – The name and dur ation  of local ▪
w ork s t ation  stored procedures is recorded.
▪perf_ajax Ajax runtime  performance messages – All Ajax requests, including the function  name, ▪
transid, dur ation,  and user are recorded.
Examples
1.To log errors and warnings only for the idwfm service, type:1.
psdebug -prog idwfm -level 2
2.To track events and stored procedures that are part of r eplic ation: 2.
psdebug.exe -prog iddb -level 5 -extlevel perf_replication